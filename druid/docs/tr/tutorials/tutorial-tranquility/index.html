<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>[译]Druid文档</title>
        <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <link rel="stylesheet" href="/markdown.css">
        <link rel="stylesheet" href="/common.css">
    </head>
    <body class="in-page">
        <div class="container-fluid">
            <div class="row">
                <div class="panel page col-md-8 col-md-offset-1">
                    <div class="panel-body">
                        <div class="page-header">
                            <h4><a href="/" class="glyphicon glyphicon-home"></a> / [译] Druid文档 / 部署教程 / Http推送流式数据</h4>
                        </div>
                        <div class="md-display markdown-body"></div>
                        <div class="md-txt" style="display:none">

### 开始

本教程阐述如何通过Tranquility服务使用HTTP把流式数据推送到Druid。  
[Tranquility服务](https://github.com/druid-io/tranquility/blob/master/docs/server.md)允许使用HTTP POST把一个数据流推送到Druid。  
在本教程，我们已经假设你已经下载安装了之前在[quickstart章节](..)介绍Druid服务。你暂不需要再加载任何数据

### 下载Tranquility
在Druid包根目录执行下面的命令:
```
curl http://static.druid.io/tranquility/releases/tranquility-distribution-0.8.2.tgz -o tranquility-distribution-0.8.2.tgz
tar -xzf tranquility-distribution-0.8.2.tgz
cd tranquility-distribution-0.8.2
```

### 执行Tranquility服务
执行:
```
bin/tranquility server -configFile ../examples/conf/tranquility/wikipedia-server.json -Ddruid.extensions.loadList=[]
```

### 发送数据
发送维基的修改样例到Tranquility:
```
curl -XPOST -H'Content-Type: application/json' --data-binary @quickstart/wikiticker-2015-09-12-sampled.json http://localhost:8200/v1/post/wikipedia
```
期望输出:
```
{"result":{"received":39244,"sent":39244}}
```
这表示HTTP服务从你这里收到了39,244项事件，和发了39,244项到Druid。这个命令可能会返回一个`connection refused`错误如果刚打开Tranquility Server不就非常快的执行，也就是说服务可能还没完全启动。应该让他启动一会。这条命令还可能在第一次执行的时候运行得久一点，这是因为这段时间Druid在找导入任务资源。一旦完成，后续的POST请求就会非常快地完成。  
数据发送到Druid之后，你就能马上查询。
如果你发现请求返回`sent`的值为0，重新发送，知道`sent`的值也是39,244
```
{"result":{"received":39244,"sent":0}}
```

### 查询数据
一到两分钟之后你的数据应该能完全可用了。你可以通过Coordinator控制台http://localhost:8081/#/ 监控这个过程。  
一旦数据加载完毕，请查看[查询教程](../tutorial-query)来对新加载的数据执行一些查询。

### 清理
如果你希望继续其他导入教程，你需要[重置集群](../#resetting-cluster-state)，因为其他教程也会写到这个`wikipedia`datasource。

### 更多
更多Tranquility信息，请浏览[Tranquility文档](/TODO)

###### 感谢大家的阅读。文中如果翻译不当的地方，欢迎指出。感谢！
                        </div>
                    </div>
                </div>
                <div class="panel nav col-md-2">
                </div>
            </div>
        </div>
        <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://cdn.bootcss.com/marked/0.3.12/marked.min.js"></script>
        <script src="/js/Druid.js"></script>
        <script>
            $(document).ready(function(){
                $(".md-display").html(marked($(".md-txt").text()))
            })
            DocsTr.navRender("/tutorial-batch")
        </script>
    </body>
</html>
